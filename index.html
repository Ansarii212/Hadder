<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>نظام التحضير</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      text-align: center;
      background-color: #f7f7f7;
      padding: 20px;
      direction: rtl;
    }
    form, table {
      margin: auto;
      max-width: 400px;
      background: white;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 20px;
      box-shadow: 0 0 10px #ccc;
    }
    input, button, select {
      width: 100%;
      padding: 10px;
      margin: 8px 0;
      font-size: 18px;
    }
    table {
      width: 90%;
      max-width: 800px;
      margin-top: 30px;
      border-collapse: collapse;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 10px;
      font-size: 16px;
    }
    th {
      background-color: #eee;
    }
    #logoutBtn {
      position: fixed;
      top: 10px;
      left: 10px;
      background-color: #e74c3c;
      color: white;
      border: none;
      padding: 10px 20px;
      cursor: pointer;
      border-radius: 5px;
    }
    @media print {
      body * {
        visibility: hidden;
      }
      #reportTable, #teacherTable, #reportTable * , #teacherTable * {
        visibility: visible;
      }
      #reportTable, #teacherTable {
        position: absolute;
        left: 0;
        top: 0;
      }
    }
  </style>
</head>
<body>

<h2 id="registerTitle">تسجيل المدير</h2>
<form id="registerForm">
  <input type="text" id="managerName" placeholder="اسم المدير" required>
  <input type="text" id="schoolName" placeholder="اسم المدرسة" required>
  <input type="text" id="managerPhone" placeholder="رقم الجوال" required>
  <input type="password" id="managerPassword" placeholder="كلمة المرور" required>
  <button type="submit">تسجيل المدير</button>
</form>

<h2>تسجيل الدخول</h2>
<form id="loginForm">
  <input type="text" id="loginPhone" placeholder="رقم الجوال">
  <input type="password" id="loginPassword" placeholder="كلمة المرور">
  <button type="submit">دخول</button>
</form>

<button id="logoutBtn" style="display:none;">تسجيل الخروج</button>

<div id="managerPage" style="display:none;">
  <h2 id="schoolTitle"></h2>
  <h3>إضافة معلم جديد</h3>
  <form id="addTeacherForm">
    <input type="text" id="teacherName" placeholder="اسم المعلم">
        <input type="text" id="teacherPhone" placeholder="رقم الجوال">
    <input type="password" id="teacherPassword" placeholder="كلمة المرور">
    <button type="submit">إضافة المعلم</button>
  </form>

  <h3>تقرير المعلمين</h3>
  <button onclick="showTeacherReport()">عرض تقرير المعلمين</button>
  <button onclick="printSection('teacherTable')">طباعة تقرير المعلمين</button>
  <table id="teacherTable" style="display:none;">
    <thead>
      <tr>
        <th>اسم المعلم</th>
        <th>رقم الجوال</th>
        <th>كلمة المرور</th>
      </tr>
    </thead>
    <tbody id="teacherReportBody"></tbody>
  </table>

  <h3>تقرير الحضور</h3>
  <button onclick="printSection('reportTable')">طباعة تقرير الحضور</button>
  <table id="reportTable">
    <thead>
      <tr>
        <th>المعلم</th>
        <th>الوقت</th>
        <th>التاريخ</th>
      </tr>
    </thead>
    <tbody id="reportBody"></tbody>
  </table>
</div>

<script>
  const teachers = [];
  const attendance = [];

  document.getElementById("registerForm").onsubmit = function (e) {
    e.preventDefault();
    alert("تم تسجيل المدير بنجاح. يمكنك الآن تسجيل الدخول.");
    document.getElementById("registerForm").reset();
  };

  document.getElementById("loginForm").onsubmit = function (e) {
    e.preventDefault();
    const phone = document.getElementById("loginPhone").value;
    const pass = document.getElementById("loginPassword").value;
    if (phone === "admin" && pass === "admin") {
      document.getElementById("managerPage").style.display = "block";
      document.getElementById("logoutBtn").style.display = "inline-block";
      document.getElementById("loginForm").style.display = "none";
      document.getElementById("registerForm").style.display = "none";
      document.getElementById("registerTitle").style.display = "none";
      document.getElementById("schoolTitle").innerText = "مدرسة المدير";
    } else {
      alert("بيانات الدخول غير صحيحة");
    }
  };

  document.getElementById("logoutBtn").onclick = function () {
    location.reload();
  };

  document.getElementById("addTeacherForm").onsubmit = function (e) {
    e.preventDefault();
    const name = document.getElementById("teacherName").value;
    const phone = document.getElementById("teacherPhone").value;
    const password = document.getElementById("teacherPassword").value;

    teachers.push({ name, phone, password });

    const now = new Date();
    const time = now.toLocaleTimeString();
    const date = now.toLocaleDateString();
    attendance.push({ name, time, date });

    document.getElementById("addTeacherForm").reset();
    alert("تمت إضافة المعلم بنجاح");
    updateAttendanceTable();
  };

  function updateAttendanceTable() {
    const tbody = document.getElementById("reportBody");
    tbody.innerHTML = "";
    attendance.forEach((entry) => {
      const row = document.createElement("tr");
      row.innerHTML = `<td>${entry.name}</td><td>${entry.time}</td><td>${entry.date}</td>`;
      tbody.appendChild(row);
    });
  }

  function showTeacherReport() {
    const tbody = document.getElementById("teacherReportBody");
    const table = document.getElementById("teacherTable");
    tbody.innerHTML = "";
    teachers.forEach((t) => {
      const row = document.createElement("tr");
      row.innerHTML = `<td>${t.name}</td><td>${t.phone}</td><td>${t.password}</td>`;
      tbody.appendChild(row);
    });
    table.style.display = "table";
  }

  function printSection(id) {
    const printContent = document.getElementById(id).outerHTML;
    const originalContent = document.body.innerHTML;
    document.body.innerHTML = printContent;
    window.print();
    document.body.innerHTML = originalContent;
    location.reload();
  }
</script>

</body>
</html>
